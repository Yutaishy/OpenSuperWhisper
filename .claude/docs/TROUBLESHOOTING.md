# トラブルシューティング

## 概要

OpenSuperWhisperで発生する可能性のある問題と解決策をまとめています。

## 2025年8月3日 解決済み問題

### 録音停止時のアプリクラッシュ

**症状：**
- 録音を停止するとアプリがクラッシュする
- エラーメッセージなしで終了
- 「処理中...」表示後にクラッシュ

**原因：**
- GUIスレッドセーフティ違反
- ワーカースレッドから直接GUI操作を実行
- PySide6ではGUI操作はメインスレッドでのみ許可

**解決策：**
- Qtシグナル（`chunk_update_signal`）を追加
- ワーカースレッドからはシグナルをemit
- メインスレッドでGUI更新を実行

**修正箇所：**
- `ui_mainwindow.py`: シグナル追加、update_chunk_display修正
- チャンク完了コールバックをスレッドセーフに

### Windows一時ファイルのロック問題

**症状：**
- `[WinError 32] プロセスはファイルにアクセスできません`
- 一時WAVファイルの削除に失敗

**原因：**
- WindowsがファイルハンドルをまだロックしているTranscriptionサービスがファイルを使用中

**解決策：**
- リトライロジックを実装（5回、0.5秒間隔）
- try-finallyでクリーンアップを確実に実行

**修正箇所：**
- `chunk_processor.py`: _process_chunk_task内のファイル削除処理

## よくある問題

### APIキーエラー

**症状：**
- `The api_key client option must be set`

**解決策：**
1. 設定画面でAPIキーを入力
2. 環境変数`OPENAI_API_KEY`を設定

### 録音が開始されない

**症状：**
- Recordボタンを押しても反応しない

**確認事項：**
1. マイクが接続されているか
2. マイクの権限が許可されているか
3. 他のアプリがマイクを使用していないか

### 文字起こし結果が表示されない

**症状：**
- 録音は成功するが結果が空

**確認事項：**
1. 音声が正しく録音されているか（無音でないか）
2. APIキーが有効か
3. インターネット接続があるか

## デバッグ方法

### ログの確認
```
logs/YYYY-MM-DD.log
```

### 詳細ログの有効化
環境変数で設定：
```
OPENSUPERWHISPER_DEBUG=1
```

## 問題が解決しない場合

1. ログファイルを確認
2. エラーメッセージを記録
3. 再現手順を整理
4. GitHubのIssueに報告